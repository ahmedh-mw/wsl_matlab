########################################
#    Installing criu
########################################
sudo add-apt-repository ppa:criu/ppa -y
sudo apt install criu -y
sudo apt update
cd /usr/sbin
sudo setcap cap_checkpoint_restore+eip criu
sudo criu check
# Should see: "Looks good."

##################
# Version: 4.1.1
##################

########################################
#    Set Options
########################################
sudo mkdir /etc/criu/
sudo nano /etc/criu/runc.conf               # <==== use this one with runc
sudo nano /etc/criu/default.conf            # <==== use this one with crun

# ------------------------------------
ghost-limit 9223372036854775807
skip-in-flight
skip-file-rwx-check
cgroup-root cpu:/new_cgroup_path
# ------------------------------------
ghost-limit 9223372036854775807
skip-in-flight
link-remap
external mnt[]:s
enable-external-masters
skip-file-rwx-check
cgroup-root cpu:/new_cgroup_path
ext-mount-map auto
# ------------------------------------
tcp-established
file-locks
tcp-close true
# ------------------------------------

sudo rm -f /etc/criu/default.conf
sudo rm -f /etc/criu/runc.conf 
